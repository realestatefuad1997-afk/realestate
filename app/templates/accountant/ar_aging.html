{% extends 'base.html' %}
{% block title %}{{ _('AR Aging') }}{% endblock %}

{% block content %}
<h3 class="mb-4 text-primary">{{ _('Accounts Receivable Aging') }}</h3>

<!-- جدول الحسابات المستحقة -->
<div class="card shadow-sm mb-4">
  <div class="card-body table-responsive">
    <table class="table table-hover table-bordered align-middle text-center mb-0">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>{{ _('Tenant') }}</th>
          <th>{{ _('Due Date') }}</th>
          <th>{{ _('Amount') }}</th>
          <th>{{ _('Days Past Due') }}</th>
          <th>{{ _('Bucket') }}</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td>{{ r.payment.id }}</td>
          <td class="fw-bold text-start">{{ r.tenant }}</td>
          <td>{{ r.payment.due_date }}</td>
          <td class="text-success fw-bold">{{ r.amount }}</td>
          <td>
            {% if r.days > 90 %}
              <span class="badge bg-danger">{{ r.days }}</span>
            {% elif r.days > 60 %}
              <span class="badge bg-warning text-dark">{{ r.days }}</span>
            {% else %}
              <span class="badge bg-success">{{ r.days }}</span>
            {% endif %}
          </td>
          <td>
            {% if r.bucket == 'current' %}
              <span class="badge bg-success">{{ _('Current') }}</span>
            {% elif r.bucket == '1-30' %}
              <span class="badge bg-info text-dark">1-30</span>
            {% elif r.bucket == '31-60' %}
              <span class="badge bg-warning text-dark">31-60</span>
            {% elif r.bucket == '61-90' %}
              <span class="badge bg-orange text-dark">61-90</span>
            {% else %}
              <span class="badge bg-danger">&gt;90</span>
            {% endif %}
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6" class="text-center text-muted">{{ _('No data') }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- الملخص -->
<div class="card shadow-sm border-0">
  <div class="card-header bg-gradient-secondary text-white fw-bold">
    {{ _('Summary') }}
  </div>
  <div class="card-body">
    <div class="row g-3 text-center">
      <div class="col-md">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-success fw-bold">{{ _('Current') }}: {{ buckets['current'] }}</div>
        </div>
      </div>
      <div class="col-md">
        <div class="card border-0 shadow-sm">
          <div class="card-body bg-info text-dark fw-bold">1-30: {{ buckets['1-30'] }}</div>
        </div>
      </div>
      <div class="col-md">
        <div class="card border-0 shadow-sm">
          <div class="card-body bg-warning text-dark fw-bold">31-60: {{ buckets['31-60'] }}</div>
        </div>
      </div>
      <div class="col-md">
        <div class="card border-0 shadow-sm">
          <div class="card-body bg-orange text-dark fw-bold">61-90: {{ buckets['61-90'] }}</div>
        </div>
      </div>
      <div class="col-md">
        <div class="card border-0 shadow-sm">
          <div class="card-body bg-danger text-white fw-bold">&gt;90: {{ buckets['>90'] }}</div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
